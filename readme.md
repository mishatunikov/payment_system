# üí≥ Payments System ‚Äî –¢–µ—Å—Ç–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ

## üìå –û–ø–∏—Å–∞–Ω–∏–µ

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç ‚Äî **—Ç–µ—Å—Ç–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ**, —Ü–µ–ª—å—é –∫–æ—Ç–æ—Ä–æ–≥–æ —è–≤–ª—è–µ—Ç—Å—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É webhook-–æ–≤ –æ—Ç –±–∞–Ω–∫–∞ –∏ –≤–µ—Å—Ç–∏ —É—á—ë—Ç –±–∞–ª–∞–Ω—Å–∞ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π –ø–æ –∏—Ö –ò–ù–ù.

### üìã –°—É—Ç—å –∑–∞–¥–∞–Ω–∏—è:

- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å API, –ø—Ä–∏–Ω–∏–º–∞—é—â–∏–π **–≤—Ö–æ–¥—è—â–∏–µ webhook-–∏** –æ—Ç –±–∞–Ω–∫–∞.
- **–°–æ–∑–¥–∞–≤–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏** –∏ **–Ω–∞—á–∏—Å–ª—è—Ç—å —Å—É–º–º—É** –Ω–∞ –±–∞–ª–∞–Ω—Å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –ø–æ `payer_inn`.
- **–û–±–µ—Å–ø–µ—á–∏—Ç—å –∑–∞—â–∏—Ç—É –æ—Ç –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π** (–ø–æ `operation_id`).
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —ç–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è **—Ç–µ–∫—É—â–µ–≥–æ –±–∞–ª–∞–Ω—Å–∞** –ø–æ –ò–ù–ù.

---

## üõ†Ô∏è –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

- Python 3.9
- Django 4.2.17
- Django REST Framework
- MySQL (–∏–ª–∏ SQLite –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

---

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–µ–∫—Ç:

```
git clone https://github.com/mishatunikov/payment_system.git
```
2. –°–æ–∑–¥–∞—Ç—å –∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:

```
python -m venv venv
```

–î–ª—è MacOS/Linux
```
source venv/bin/activate  
```
–î–ª—è Windows:
```
venv\Scripts\activate
```

3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```
pip install -r requirements/requirements.txt
```

4. –í—ã–ø–æ–ª–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏:

```
python manage.py migrate
```

5. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä:

```
python manage.py runserver
```

## üîå API –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã
POST /api/webhook/bank/

–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥—è—â–µ–≥–æ webhook-–∞ –æ—Ç –±–∞–Ω–∫–∞.
–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:
```
{
  "operation_id": "ccf0a86d-041b-4991-bcf7-e2352f7b8a4a",
  "amount": 145000,
  "payer_inn": "1234567890",
  "document_number": "PAY-328",
  "document_date": "2024-04-27T21:00:00Z"
}
```
–ü–æ–≤–µ–¥–µ–Ω–∏–µ:

    ‚úÖ –ï—Å–ª–∏ –æ–ø–µ—Ä–∞—Ü–∏—è —Å —Ç–∞–∫–∏–º operation_id —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è 200 OK, –±–∞–ª–∞–Ω—Å –Ω–µ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è.

    ‚ûï –ï—Å–ª–∏ –Ω–æ–≤–∞—è ‚Äî —Å–æ–∑–¥–∞—ë—Ç—Å—è –æ–±—ä–µ–∫—Ç Payment, –∏–∑–º–µ–Ω—è–µ—Ç—Å—è –±–∞–ª–∞–Ω—Å, –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –∏–∑–º–µ–Ω–µ–Ω–∏–µ.

üìä GET /api/organizations/<inn>/balance/

–ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –±–∞–ª–∞–Ω—Å–∞ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –ø–æ –ò–ù–ù.
–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:
```
{
  "inn": "1234567890",
  "balance": 145000
}
```
